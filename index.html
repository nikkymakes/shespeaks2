<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>She Speaks: The Many Faces of Her‚Ñ¢</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #f5f0e8 0%, #e8dfd0 100%);
            min-height: 100vh;
            color: #3d2817;
        }
        .app-container { max-width: 900px; margin: 0 auto; padding: 2rem; }
        .header {
            text-align: center; margin-bottom: 3rem; padding: 2rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        .header h1 {
            font-size: 2.5rem; margin-bottom: 0.5rem;
            color: #8b4513; font-weight: 400; letter-spacing: 1px;
        }
        .header p { font-size: 1.1rem; color: #5c4033; font-style: italic; }
        .badge {
            display: inline-block; background: #8b4513; color: white;
            padding: 0.5rem 1rem; border-radius: 20px;
            font-size: 0.85rem; margin-top: 0.5rem;
        }
        .search-bar { margin-bottom: 2rem; }
        .search-input {
            width: 100%; padding: 1rem; border: 2px solid #c4a57b;
            border-radius: 8px; font-family: 'Georgia', serif; font-size: 1rem;
        }
        .emotional-pathways {
            background: white; padding: 2rem; border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08); margin-bottom: 2rem;
        }
        .emotional-pathways h3 { color: #8b4513; margin-bottom: 1rem; font-size: 1.3rem; }
        .pathway-btn {
            display: block; width: 100%; padding: 1rem; margin-bottom: 0.75rem;
            background: linear-gradient(135deg, #f8f5f0 0%, #e8dfd0 100%);
            border: 2px solid #c4a57b; border-radius: 8px; cursor: pointer;
            text-align: left; font-family: 'Georgia', serif; font-size: 0.95rem;
            transition: all 0.3s ease;
        }
        .pathway-btn:hover {
            background: linear-gradient(135deg, #e8dfd0 0%, #d4c5b0 100%);
            transform: translateY(-2px);
        }
        .women-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem; margin-bottom: 3rem;
        }
        .woman-card {
            background: white; padding: 1.5rem; border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); cursor: pointer;
            transition: all 0.3s ease; border-left: 4px solid #8b4513;
        }
        .woman-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        .woman-card h3 { color: #8b4513; margin-bottom: 0.5rem; font-size: 1.2rem; }
        .woman-card .testament {
            font-size: 0.75rem; color: #8b4513;
            background: rgba(139, 69, 19, 0.1);
            padding: 0.25rem 0.5rem; border-radius: 4px;
            display: inline-block; margin-bottom: 0.5rem;
        }
        .woman-card p { color: #5c4033; font-size: 0.9rem; line-height: 1.6; }
        .interpretation-view {
            background: white; padding: 3rem; border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08); margin-bottom: 2rem;
        }
        .interpretation-header {
            text-align: center; padding-bottom: 2rem;
            border-bottom: 2px solid #e0d5c7; margin-bottom: 2rem;
        }
        .interpretation-header h2 { color: #8b4513; font-size: 2rem; margin-bottom: 1rem; }
        .interpretation-content {
            line-height: 1.9; font-size: 1.05rem; color: #4a3728;
            white-space: pre-wrap; margin-bottom: 2rem;
        }
        .journal-section {
            background: linear-gradient(135deg, #f8f5f0 0%, #e8dfd0 100%);
            padding: 2rem; border-radius: 12px; margin-top: 2rem;
        }
        .journal-section h3 { color: #8b4513; margin-bottom: 1rem; font-size: 1.3rem; }
        .journal-textarea {
            width: 100%; min-height: 150px; padding: 1rem;
            border: 2px solid #c4a57b; border-radius: 8px;
            font-family: 'Georgia', serif; font-size: 1rem;
            line-height: 1.8; resize: vertical;
        }
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem; margin-top: 2rem;
        }
        .btn {
            padding: 1rem;
            background: linear-gradient(135deg, #8b4513 0%, #6b3410 100%);
            color: white; border: none; border-radius: 8px; cursor: pointer;
            font-size: 1rem; font-weight: 600; transition: all 0.3s ease;
            font-family: 'Georgia', serif; text-align: center;
        }
        .btn:hover {
            background: linear-gradient(135deg, #6b3410 0%, #4b2408 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        .btn-secondary {
            background: white; color: #8b4513; border: 2px solid #8b4513;
        }
        .btn-secondary:hover { background: #8b4513; color: white; }
        .back-btn {
            display: inline-block; margin-bottom: 2rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #e8dfd0 0%, #c4a57b 100%);
            color: #3d2817; border: none; border-radius: 8px;
            cursor: pointer; font-size: 1rem; text-decoration: none;
            transition: all 0.3s ease; font-family: 'Georgia', serif;
        }
        .back-btn:hover {
            background: linear-gradient(135deg, #c4a57b 0%, #a48860 100%);
            transform: translateY(-2px);
        }
        .footer {
            text-align: center; padding: 2rem; margin-top: 3rem;
            font-size: 0.9rem; color: #5c4033; font-style: italic;
            background: rgba(255, 255, 255, 0.5); border-radius: 8px;
        }
        .share-options {
            display: flex; gap: 1rem; margin-top: 1rem;
            flex-wrap: wrap; justify-content: center;
        }
        .share-btn {
            padding: 0.75rem 1.5rem; background: white; color: #8b4513;
            border: 2px solid #8b4513; border-radius: 8px; cursor: pointer;
            font-size: 0.9rem; font-weight: 600; text-decoration: none;
            transition: all 0.3s ease; font-family: 'Georgia', serif;
        }
        .share-btn:hover { background: #8b4513; color: white; }
        .loading { text-align: center; padding: 2rem; color: #8b4513; font-style: italic; }
        @media (max-width: 768px) {
            .app-container { padding: 1rem; }
            .header h1 { font-size: 1.8rem; }
            .women-grid { grid-template-columns: 1fr; }
            .interpretation-view { padding: 1.5rem; }
            .action-buttons { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // BIBLICAL WOMEN DATABASE - with actual narrative details
        const BIBLICAL_WOMEN = [
            { 
                name: "Hagar", testament: "OT", role: "Egyptian Servant",
                story: "Enslaved servant given to Abraham as surrogate. Fled to wilderness when mistreated. God met her there and she named Him 'El Roi' - The God Who Sees. Gave birth to Ishmael. Later expelled with her son into desert. God provided water and promised Ishmael would become a great nation.",
                keyMoments: ["enslaved", "used as surrogate", "fled mistreatment", "met God in wilderness", "named God", "expelled", "God provided"],
                emotions: ["overlooked", "used", "abandoned", "seen by God"],
                scripture: "Genesis 16, 21"
            },
            { 
                name: "Ruth", testament: "OT", role: "Moabite Widow",
                story: "Moabite woman who married into Israelite family. After husband died, refused to leave mother-in-law Naomi. Declared 'Where you go, I go.' Traveled to Bethlehem as foreigner. Worked in fields gleaning grain. Caught attention of Boaz through her loyalty. Married Boaz. Became great-grandmother of King David.",
                keyMoments: ["widowed", "chose loyalty over safety", "worked as gleaner", "proposed marriage", "became ancestor of David"],
                emotions: ["loyal", "choosing family", "outsider", "redeemed"],
                scripture: "Book of Ruth"
            },
            { 
                name: "Esther", testament: "OT", role: "Jewish Queen of Persia",
                story: "Jewish orphan raised by cousin Mordecai. Hidden her identity to become queen of Persia. When genocide decree threatened her people, faced choice: stay silent and safe, or speak up and risk death. Fasted three days. Approached king uninvited (punishable by death). Threw strategic banquets. Revealed her identity and saved her people from annihilation.",
                keyMoments: ["hidden identity", "became queen", "genocide threat", "fasted", "risked death approaching king", "strategic banquets", "revealed identity", "saved her people"],
                emotions: ["hidden", "strategic", "courageous", "timing"],
                scripture: "Book of Esther"
            },
            { 
                name: "Mary Magdalene", testament: "NT", role: "Disciple & First Witness",
                story: "Delivered from seven demons by Jesus. Became devoted follower. Supported Jesus' ministry financially. Stayed at the cross when others fled. First to discover empty tomb. First to see risen Christ. Commissioned to tell disciples 'I have seen the Lord.' Called 'apostle to the apostles.'",
                keyMoments: ["delivered from demons", "devoted follower", "stayed at cross", "first at tomb", "first resurrection witness", "sent to tell others"],
                emotions: ["delivered", "devoted", "witnessed death", "witnessed resurrection"],
                scripture: "Luke 8; John 19-20"
            },
            { 
                name: "Deborah", testament: "OT", role: "Judge & Prophetess",
                story: "Only female judge in Israel. Prophet and military leader. Held court under palm tree settling disputes. Called reluctant commander Barak to lead army. He refused unless she came. She agreed but prophesied a woman would get credit for victory. Jael killed enemy commander. Deborah sang victory song celebrating women's courage.",
                keyMoments: ["judge of Israel", "prophet", "called Barak to battle", "went to war", "led to victory", "sang victory song"],
                emotions: ["leadership", "prophetic", "courage", "strategic"],
                scripture: "Judges 4-5"
            },
            { 
                name: "Rahab", testament: "OT", role: "Canaanite Prostitute",
                story: "Prostitute in Jericho who hid Israelite spies on her roof. Lied to protect them. Made covenant with spies: save my family when you conquer. Hung scarlet cord from window as sign. Family spared when Jericho fell. Joined Israelite community. Married Salmon. Became great-great-grandmother of King David. Listed in Jesus' genealogy.",
                keyMoments: ["hid spies", "lied to protect them", "made covenant", "scarlet cord signal", "family saved", "married into Israel", "ancestor of David and Jesus"],
                emotions: ["faith despite occupation", "protective", "redemption", "ancestral"],
                scripture: "Joshua 2, 6; Matthew 1"
            }
        ];

        const EMOTIONAL_PATHWAYS = [
            { label: "I feel overlooked and forgotten", matches: ["Hagar"] },
            { label: "I've made mistakes I can't outgrow", matches: ["Rahab", "Mary Magdalene"] },
            { label: "I'm standing by someone else's pain", matches: ["Ruth"] },
            { label: "I'm being called to lead, but it's lonely", matches: ["Deborah", "Esther"] },
            { label: "I've experienced violation or injustice", matches: ["Hagar"] },
            { label: "I'm choosing to stay when leaving would be easier", matches: ["Ruth"] }
        ];

        // SMART INTERPRETATION GENERATOR - Actually reasons about the story!
        class InterpretationGenerator {
            constructor(woman) {
                this.woman = woman;
            }

            generate() {
                return `She Speaks: The Many Faces of ${this.woman.name}

${this.generateAbide365()}

${this.generateFractaSelf()}

${this.generateTheArc()}

${this.generateSatiricalQuill()}`;
            }

            // ABIDE 365: Extract spiritual lesson from her actual story
            generateAbide365() {
                const { name, story, keyMoments, emotions, scripture } = this.woman;
                
                // Analyze her story to find the core tension
                const hasViolation = keyMoments.some(m => m.includes('enslaved') || m.includes('violated') || m.includes('abandoned'));
                const hasChoice = keyMoments.some(m => m.includes('chose') || m.includes('refused') || m.includes('declared'));
                const hasEncounter = keyMoments.some(m => m.includes('met God') || m.includes('delivered') || m.includes('witness'));
                const hasRisk = keyMoments.some(m => m.includes('risked') || m.includes('approached king') || m.includes('hid'));
                
                let coreLesson = '';
                if (hasViolation && hasEncounter) {
                    coreLesson = `${name} teaches us that being unseen by people does not mean being unseen by God. In her darkest moment‚Äîused, abandoned, invisible‚Äîthe Divine met her. She discovered that human exploitation cannot erase divine acknowledgment.`;
                } else if (hasChoice && hasRisk) {
                    coreLesson = `${name} teaches us about choices that cost us everything. She faced a crossroads where safety beckoned on one side and calling on the other. She chose the harder path, and in that choice, wrote a story larger than her own survival.`;
                } else if (hasEncounter) {
                    coreLesson = `${name} teaches us about the transformative power of encounter. Before she met the Divine, she was one thing. After, she became another. Deliverance changed not just her circumstances but her identity.`;
                } else {
                    coreLesson = `${name} teaches us about the courage required to live authentically in a world that demands conformity. Her story is one of resistance, resilience, and the refusal to be reduced to a single narrative.`;
                }

                return `üïä Abide 365

${coreLesson}

Her story (${scripture}) is not sanitized. It includes ${keyMoments.slice(0, 3).join(', ')}. These are not metaphors‚Äîthese are the raw materials of her life. And yet, from this complexity emerges a testimony about ${emotions[emotions.length - 1]}.

She reminds us that our struggles are not obstacles to our purpose but often the very soil from which it grows.

Reflect: Where in ${name}'s journey do you see echoes of your own? What does her courage, her pain, or her choices reveal about the path you're walking?

If you feel led to give, consider supporting organizations that serve women in similar circumstances.`;
            }

            // FRACTASELF: Assign archetype based on her actual actions
            generateFractaSelf() {
                const { name, keyMoments, emotions } = this.woman;
                
                // Determine FractaType by analyzing her actions
                let fractaType = '';
                if (keyMoments.some(m => m.includes('named God'))) {
                    fractaType = 'The God-Namer';
                } else if (keyMoments.some(m => m.includes('first') && m.includes('witness'))) {
                    fractaType = 'The First Witness';
                } else if (keyMoments.some(m => m.includes('refused') || m.includes('chose loyalty'))) {
                    fractaType = 'The Covenant Keeper';
                } else if (keyMoments.some(m => m.includes('hidden identity') || m.includes('strategic'))) {
                    fractaType = 'The Strategic Revealer';
                } else if (keyMoments.some(m => m.includes('judge') || m.includes('led'))) {
                    fractaType = 'The Reluctant Commander';
                } else if (keyMoments.some(m => m.includes('hid') || m.includes('protected'))) {
                    fractaType = 'The Protective Conspirator';
                } else {
                    fractaType = 'The Courageous One';
                }

                // Generate starter pack based on her actual story elements
                const starterPack = this.generateStarterPack();

                return `üß© FractaSelf

‚Ä¢ FractaType: ${fractaType}

‚Ä¢ Identity Reflection: ${name} carries the paradox of ${emotions[0]} and ${emotions[emotions.length - 1]}. She is both the one who ${keyMoments[0]} and the one who ${keyMoments[keyMoments.length - 1]}.

‚Ä¢ Starter Pack:
${starterPack.map(item => `  - ${item}`).join('\n')}

‚Ä¢ Toy-box Image Prompt: Create a clean, single-image action-figure packaging illustration of '${fractaType}'. Include symbolic accessories: ${starterPack.slice(0, 3).join(', ').toLowerCase()}. One figure only, inside a clear plastic toy box. Minimalist packaging, earthy biblical tones with touches of ${this.getColorForEmotion()}.

‚Ä¢ Caption: For every woman who has ${keyMoments[0]} and still found the strength to ${keyMoments[keyMoments.length - 1]}. ${name} shows us that our stories matter, our voices count, and our journeys shape the future.`;
            }

            generateStarterPack() {
                const { keyMoments } = this.woman;
                const items = [];
                
                if (keyMoments.some(m => m.includes('wilderness') || m.includes('desert'))) {
                    items.push('A waterskin (survival in impossible places)');
                }
                if (keyMoments.some(m => m.includes('named'))) {
                    items.push('A scroll with divine name (authority to name the sacred)');
                }
                if (keyMoments.some(m => m.includes('scarlet cord') || m.includes('signal'))) {
                    items.push('A scarlet cord (covenant sign)');
                }
                if (keyMoments.some(m => m.includes('gleaning') || m.includes('worked'))) {
                    items.push('Stalks of grain (dignity in labor)');
                }
                if (keyMoments.some(m => m.includes('banquet') || m.includes('feast'))) {
                    items.push('A feast invitation (strategic hospitality)');
                }
                if (keyMoments.some(m => m.includes('tomb') || m.includes('witness'))) {
                    items.push('An empty tomb (testimony of resurrection)');
                }
                if (keyMoments.some(m => m.includes('fasted'))) {
                    items.push('Sackcloth hidden under silk (private mourning, public courage)');
                }
                if (keyMoments.some(m => m.includes('palm tree') || m.includes('judge'))) {
                    items.push('A gavel from palm wood (justice delivered)');
                }
                
                // Always include these universal items
                items.push('A voice that speaks truth');
                items.push('Courage wrapped in vulnerability');
                
                return items.slice(0, 5);
            }

            getColorForEmotion() {
                const { emotions } = this.woman;
                if (emotions.includes('abandoned')) return 'desert gold';
                if (emotions.includes('loyal')) return 'harvest amber';
                if (emotions.includes('strategic')) return 'royal purple';
                if (emotions.includes('delivered')) return 'dawn light';
                if (emotions.includes('leadership')) return 'olive green';
                return 'soft earth tones';
            }

            // THE ARC: Retell her story as timeless allegory
            generateTheArc() {
                const { name, keyMoments } = this.woman;
                
                const beginning = keyMoments[0];
                const middle = keyMoments[Math.floor(keyMoments.length / 2)];
                const end = keyMoments[keyMoments.length - 1];

                return `üåà The Arc

There was a woman whose story began with ${beginning}. She lived in a world that ${this.analyzePowerStructure()}.

At the crossroads of her life, she ${middle}. This was not the easy choice. This was not the expected choice. But it was her choice.

And in that moment of decision, something ancient and eternal whispered through her story. She became more than her circumstances. She became a witness to what happens when ${this.extractMoral()}.

Her name was ${name}, but she is every woman who has ever stood at the edge of expectation and chosen to leap.

The moral: ${this.generateMoral()}`;
            }

            analyzePowerStructure() {
                const { keyMoments } = this.woman;
                if (keyMoments.some(m => m.includes('enslaved'))) return 'traded in her body without her consent';
                if (keyMoments.some(m => m.includes('widow'))) return 'left women vulnerable and voiceless';
                if (keyMoments.some(m => m.includes('hidden identity'))) return 'required concealment for survival';
                if (keyMoments.some(m => m.includes('prostitute'))) return 'criminalized survival';
                return 'measured women by their utility to men';
            }

            extractMoral() {
                const { emotions } = this.woman;
                if (emotions.includes('seen by God')) return 'divine witness meets human invisibility';
                if (emotions.includes('loyal')) return 'chosen family proves stronger than blood';
                if (emotions.includes('courageous')) return 'silence becomes complicity and speech becomes salvation';
                if (emotions.includes('delivered')) return 'deliverance transforms testimony';
                return 'courage overcomes circumstance';
            }

            generateMoral() {
                const { keyMoments } = this.woman;
                const lastMoment = keyMoments[keyMoments.length - 1];
                
                return `The stories that matter most are often written by those who ${keyMoments[0]} but refused to let that be their ending. Instead, they ${lastMoment}.`;
            }

            // SATIRICAL QUILL: Actually roast the biblical treatment
            generateSatiricalQuill() {
                const { name, role, keyMoments, testament } = this.woman;
                
                const verseCount = this.estimateVerseCount();
                const overlookedMoment = this.findOverlookedMoment();

                return `ü™û Satirical Quill‚Ñ¢

Ah, ${name}. The biblical writers gave her "${role}" status, which in ancient ${testament} terms means she got roughly ${verseCount} verses while the men got entire genealogies that put your Ancestry.com results to shame.

Let's talk about what actually happened: ${keyMoments[0]}. But here's where it gets interesting‚Äîthe part where ${overlookedMoment}? Yeah, that tends to get glossed over in Sunday School. Too messy. Too real. Too much agency for a woman in a patriarchal text.

${this.generateCritique()}

But here's what the sanitized versions miss: ${name} didn't wait for permission. She didn't ask if her story was "appropriate." She ${keyMoments[keyMoments.length - 1]}, and that act of defiance, survival, or faith (often all three) made it into a book that's spent millennia trying to downplay women's voices.

So next time someone tries to reduce ${name} to a one-dimensional moral lesson, remember: she was a whole person who made real choices in impossible circumstances. And that's more revolutionary than any sermon.

In jest, truth; in truth, jest. ‚Äî The Quill`;
            }

            estimateVerseCount() {
                const { keyMoments } = this.woman;
                if (keyMoments.length > 10) return '50+';
                if (keyMoments.length > 5) return '10-20';
                return '3-5';
            }

            findOverlookedMoment() {
                const { keyMoments } = this.woman;
                if (keyMoments.some(m => m.includes('named God'))) return 'she named God before any patriarch did';
                if (keyMoments.some(m => m.includes('lied'))) return 'she straight-up lied to protect the spies';
                if (keyMoments.some(m => m.includes('strategic'))) return 'she manipulated the system';
                if (keyMoments.some(m => m.includes('first witness'))) return 'she was commissioned as apostle';
                return 'she made choices that shaped nations';
            }

            generateCritique() {
                const { name, keyMoments } = this.woman;
                
                if (keyMoments.some(m => m.includes('enslaved') || m.includes('used'))) {
                    return `And naturally, when the whole "using a enslaved woman as a surrogate" plan blew up, guess who got blamed? Not the patriarchs making these decisions. Nope. ${name}.`;
                }
                if (keyMoments.some(m => m.includes('hidden identity'))) {
                    return `She had to hide who she was just to survive, then reveal it to save everyone. And somehow this gets turned into a story about "God's timing" rather than what it actually is: a woman navigating a genocidal empire.`;
                }
                if (keyMoments.some(m => m.includes('delivered from demons'))) {
                    return `Seven demons cast out, and for centuries she got labeled a prostitute (spoiler: the Bible never says that). Classic move: if a woman is too free, too devoted, too visible, make her scandalous.`;
                }
                if (keyMoments.some(m => m.includes('hid spies'))) {
                    return `A sex worker who committed treason gets into Jesus' family tree, which is either radical grace or the Bible admitting that "respectable" families are built on complicated women.`;
                }
                return `Because apparently, women can't just be complex humans with agency. They have to be moral lessons, cautionary tales, or footnotes.`;
            }

            getShareQuote() {
                const { keyMoments } = this.woman;
                const lastMoment = keyMoments[keyMoments.length - 1];
                return `The stories that matter most are often written by those who ${keyMoments[0]} but refused to let that be their ending. Instead, they ${lastMoment}.`;
            }
        }

        // Storage & Export (same as before)
        const JournalStorage = {
            save: (womanName, journalText) => {
                const journals = JSON.parse(localStorage.getItem('sheSpeaksJournals') || '{}');
                if (!journals[womanName]) journals[womanName] = [];
                journals[womanName].push({ id: Date.now(), text: journalText, date: new Date().toISOString() });
                localStorage.setItem('sheSpeaksJournals', JSON.stringify(journals));
            },
            getAll: () => JSON.parse(localStorage.getItem('sheSpeaksJournals') || '{}')
        };

        const ExportHelper = {
            downloadPDF: (womanName, content, journalEntries) => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                let y = 20;
                
                doc.setFontSize(18);
                doc.setTextColor(139, 69, 19);
                doc.text(`She Speaks: ${womanName}`, 20, y);
                y += 15;
                
                doc.setFontSize(11);
                doc.setTextColor(60, 40, 23);
                const lines = doc.splitTextToSize(content, 170);
                doc.text(lines, 20, y);
                y += lines.length * 5 + 20;
                
                if (journalEntries?.length) {
                    if (y > 250) { doc.addPage(); y = 20; }
                    doc.setFontSize(14);
                    doc.setTextColor(139, 69, 19);
                    doc.text("My Reflections", 20, y);
                    y += 10;
                    
                    journalEntries.forEach(entry => {
                        if (y > 250) { doc.addPage(); y = 20; }
                        doc.setFontSize(9);
                        doc.setTextColor(92, 64, 51);
                        doc.text(new Date(entry.date).toLocaleDateString(), 20, y);
                        y += 7;
                        doc.setFontSize(11);
                        doc.setTextColor(60, 40, 23);
                        const entryLines = doc.splitTextToSize(entry.text, 170);
                        doc.text(entryLines, 20, y);
                        y += entryLines.length * 5 + 10;
                    });
                }
                
                doc.setFontSize(9);
                doc.setTextColor(92, 64, 51);
                doc.text('¬© Adenike Omoregbee. All rights reserved.', 20, 285);
                doc.save(`she-speaks-${womanName.toLowerCase().replace(/\s/g, '-')}.pdf`);
            },
            
            share: (womanName, quote, platform) => {
                const text = `${quote}\n\nShe Speaks: The Many Faces of Her‚Ñ¢\n#SheSpeaks #BiblicalWomen #${womanName.replace(/\s/g, '')}`;
                const url = window.location.href;
                const urls = {
                    twitter: `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`,
                    facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&quote=${encodeURIComponent(text)}`,
                    linkedin: `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`,
                    whatsapp: `https://wa.me/?text=${encodeURIComponent(text + ' ' + url)}`
                };
                if (urls[platform]) window.open(urls[platform], '_blank', 'width=600,height=400');
            }
        };

        function App() {
            const [view, setView] = useState('home');
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedWoman, setSelectedWoman] = useState(null);
            const [interpretation, setInterpretation] = useState('');
            const [journalText, setJournalText] = useState('');
            const [journals, setJournals] = useState({});
            const [isGenerating, setIsGenerating] = useState(false);

            useEffect(() => { setJournals(JournalStorage.getAll()); }, []);

            const filteredWomen = BIBLICAL_WOMEN.filter(w => 
                w.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                w.role.toLowerCase().includes(searchTerm.toLowerCase())
            );

            const handleSelectWoman = (woman) => {
                setSelectedWoman(woman);
                setIsGenerating(true);
                setView('woman');
                setJournalText('');
                setTimeout(() => {
                    const generator = new InterpretationGenerator(woman);
                    setInterpretation(generator.generate());
                    setIsGenerating(false);
                }, 100);
            };

            const handlePathwayClick = (pathway) => {
                const matchedName = pathway.matches[0];
                const woman = BIBLICAL_WOMEN.find(w => w.name === matchedName);
                if (woman) handleSelectWoman(woman);
            };

            const handleSaveJournal = () => {
                if (journalText.trim() && selectedWoman) {
                    JournalStorage.save(selectedWoman.name, journalText.trim());
                    setJournals(JournalStorage.getAll());
                    alert('Journal entry saved!');
                    setJournalText('');
                }
            };

            const renderHome = () => (
                <>
                    <div className="header">
                        <h1>She Speaks: The Many Faces of Her‚Ñ¢</h1>
                        <p>Four lenses. One voice. Her story reimagined.</p>
                        <div className="badge">Smart Edition - Code That Reasons</div>
                    </div>

                    <div className="emotional-pathways">
                        <h3>üåø What are you walking through right now?</h3>
                        {EMOTIONAL_PATHWAYS.map((pathway, idx) => (
                            <button key={idx} className="pathway-btn" onClick={() => handlePathwayClick(pathway)}>
                                ‚Ä¢ {pathway.label}
                            </button>
                        ))}
                    </div>

                    <div className="search-bar">
                        <input type="text" className="search-input" placeholder="Search by name or role..."
                            value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                    </div>

                    <div className="women-grid">
                        {filteredWomen.map((woman, idx) => (
                            <div key={idx} className="woman-card" onClick={() => handleSelectWoman(woman)}>
                                <div className="testament">{woman.testament}</div>
                                <h3>{woman.name}</h3>
                                <p>{woman.role}</p>
                                <p style={{marginTop: '0.5rem', fontSize: '0.85rem', fontStyle: 'italic'}}>
                                    {woman.story.substring(0, 80)}...
                                </p>
                                {journals[woman.name] && (
                                    <p style={{marginTop: '0.5rem', fontSize: '0.85rem', color: '#8b4513'}}>
                                        üìù {journals[woman.name].length} journal {journals[woman.name].length === 1 ? 'entry' : 'entries'}
                                    </p>
                                )}
                            </div>
                        ))}
                    </div>
                </>
            );

            const renderWoman = () => {
                const generator = new InterpretationGenerator(selectedWoman);
                const shareQuote = generator.getShareQuote();

                return (
                    <>
                        <button className="back-btn" onClick={() => setView('home')}>‚Üê Back to All Women</button>

                        <div className="interpretation-view">
                            <div className="interpretation-header">
                                <h2>She Speaks: The Many Faces of {selectedWoman.name}</h2>
                                <div style={{fontSize: '0.9rem', color: '#5c4033', marginTop: '0.5rem'}}>
                                    {selectedWoman.testament} ‚Ä¢ {selectedWoman.role}
                                </div>
                            </div>

                            {isGenerating ? (
                                <div className="loading">Generating four-lens interpretation...</div>
                            ) : (
                                <>
                                    <div className="interpretation-content">{interpretation}</div>

                                    <div className="journal-section">
                                        <h3>‚úçÔ∏è Your Personal Reflection</h3>
                                        <textarea className="journal-textarea" placeholder="Write your reflection here..."
                                            value={journalText} onChange={(e) => setJournalText(e.target.value)} />
                                        <div className="action-buttons">
                                            <button className="btn" onClick={handleSaveJournal}>üíæ Save Journal Entry</button>
                                            <button className="btn btn-secondary" onClick={() => ExportHelper.downloadPDF(
                                                selectedWoman.name, interpretation, journals[selectedWoman.name])}>
                                                üìÑ Export as PDF
                                            </button>
                                        </div>
                                    </div>

                                    <div style={{marginTop: '2rem', textAlign: 'center'}}>
                                        <h3 style={{color: '#8b4513', marginBottom: '1rem'}}>üì± Share on Social Media</h3>
                                        <div className="share-options">
                                            <button className="share-btn" onClick={() => ExportHelper.share(selectedWoman.name, shareQuote, 'twitter')}>üê¶ Twitter</button>
                                            <button className="share-btn" onClick={() => ExportHelper.share(selectedWoman.name, shareQuote, 'facebook')}>üìò Facebook</button>
                                            <button className="share-btn" onClick={() => ExportHelper.share(selectedWoman.name, shareQuote, 'linkedin')}>üíº LinkedIn</button>
                                            <button className="share-btn" onClick={() => ExportHelper.share(selectedWoman.name, shareQuote, 'whatsapp')}>üí¨ WhatsApp</button>
                                            <button className="share-btn" onClick={() => navigator.clipboard.writeText(shareQuote).then(() => alert('Quote copied!'))}>üìã Copy Quote</button>
                                        </div>
                                    </div>
                                </>
                            )}
                        </div>
                    </>
                );
            };

            return (
                <div className="app-container">
                    {view === 'home' && renderHome()}
                    {view === 'woman' && selectedWoman && renderWoman()}
                    <div className="footer">¬© Adenike Omoregbee. All rights reserved.</div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>